col_Verb<-list(c(Verb_N_Syll_1/rows_Verb))
first_Col<-paste0("R", sprintf("%04d", 1:1000))
stress_shift_replications<-data.frame(first_Col,col_Noun,col_Verb)
col_Name_first_col<-"Identification"
col_Noun_name<-"Noun_Percent_Syll_1"
col_Verb_name<-"Verb_Percent_Syll_1"
names(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name)
difference<-stress_shift_replications[2]-stress_shift_replications[3]
stress_shift_replications<-cbind(stress_shift_replications,di=difference)
colnames(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name,"Difference_in_Proportion")
p<-ggplot2::ggplot(stress_shift_replications,ggplot2::aes_string(x="Difference_in_Proportion",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=original_Difference))+ggplot2::xlim(c(-0.1, 0.8))
p_2<-ggplot2::ggplot(ptest_d,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=median(ptest_stress$observed)))+ggplot2::xlim(c(-0.1, 0.8))
print (p)
print (p_2)
Noun_N_Syll_1<-c(4881,4918)
Verb_N_Syll_1<-c(477,487)
stress_shift_replications <- stress_shift_replications %>%
dplyr::mutate(
Permutation_Pvalue=v_pdp_pvalue_right(Noun_N_Syll_1,Verb_N_Syll_1,rows_Noun,rows_Verb))
stress_shift_replications <- stress_shift_replications %>%
dplyr::mutate(
Permutation_Pvalue=v_pdp_pvalue_right(Noun_N_Syll_1,Verb_N_Syll_1,rows_Noun,rows_Verb))
stress_shift_replications <- stress_shift_replications %>%
dplyr::mutate(
Permutation_Pvalue=v_pdp_pvalue_right(Noun_N_Syll_1,Verb_N_Syll_1,rows_Noun,rows_Verb))
propotion_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(Percent_Syll_1=sum(Syllable=="Syllable 1")/n())
percentage_Syllable_1_Noun<-propotion_syllable$Percent_Syll_1[1]
percentage_Syllable_1_Verb<-propotion_syllable$Percent_Syll_1[2]
original_Difference<-percentage_Syllable_1_Noun-percentage_Syllable_1_Verb
rows_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(rows_for_cate=n())
rows_Noun<-rows_syllable$rows_for_cate[1]
rows_Verb<-rows_syllable$rows_for_cate[2]
Noun_N_Syll_1<-rbinom(1000,rows_Noun,percentage_Syllable_1_Noun)
Verb_N_Syll_1<-rbinom(1000,rows_Verb,percentage_Syllable_1_Verb)
col_Noun<-list(c(Noun_N_Syll_1/rows_Noun))
col_Verb<-list(c(Verb_N_Syll_1/rows_Verb))
first_Col<-paste0("R", sprintf("%04d", 1:1000))
stress_shift_replications<-data.frame(first_Col,col_Noun,col_Verb)
col_Name_first_col<-"Identification"
col_Noun_name<-"Noun_Percent_Syll_1"
col_Verb_name<-"Verb_Percent_Syll_1"
names(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name)
difference<-stress_shift_replications[2]-stress_shift_replications[3]
stress_shift_replications<-cbind(stress_shift_replications,di=difference)
colnames(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name,"Difference_in_Proportion")
p<-ggplot2::ggplot(stress_shift_replications,ggplot2::aes_string(x="Difference_in_Proportion",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=original_Difference))+ggplot2::xlim(c(-0.1, 0.8))
p_2<-ggplot2::ggplot(ptest_d,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=median(ptest_stress$observed)))+ggplot2::xlim(c(-0.1, 0.8))
print (p)
print (p_2)
stress_shift_replications <- stress_shift_replications %>%
dplyr::mutate(
Permutation_Pvalue=v_pdp_pvalue_right(Noun_N_Syll_1,Verb_N_Syll_1,rows_Noun,rows_Verb))
stress_shift_replications <- stress_shift_replications %>%
dplyr::mutate(
Permutation_Pvalue=v_pdp_pvalue_right(Noun_N_Syll_1,Verb_N_Syll_1,rows_Noun,rows_Verb))
n_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(Percent_Syll_1=sum(Syllable=="Syllable 1"))
n_Noun<-n_syllable$Percent_Syll_1[1]
n_Verb<-n_syllable$Percent_Syll_1[1]
print( permtest_difference_in_props(n_Noun,n_Verb,rows_Noun,rows_Verb))
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Noun")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Noun")
source("Assignement3function.R")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Noun")
test
source("Assignement3function.R")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Category", "Syllable")
test
source("Assignement3function.R")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Category")
test
source("Assignement3function.R")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Category")
test
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat, n_samples=9999, "Category")
source("Assignement3function.R")
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat, n_samples=9999, "Category")
source("Assignement3function.R")
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat, n_samples=9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm, group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat, n_samples=9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm, group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm, group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category","Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm, group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (group_var)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (var_to_permute)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (statistic)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (group_var)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (n_samples)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,999,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (group_var)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,999,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return (group_var)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
res
source("Assignement3function.R")
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm, group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
return(group_var)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute,"Syllable")
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm, group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(group_var)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9999, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9999,"Category")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,1,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,9,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,999,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Category", pearson_x2_stat,999,"Syllable")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,1,"Category")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Category", pearson_x2_stat,1,"Syllable")
res
stressshift::stress_shift_unamb
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,1,"Word")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
p_3<-ggplot2::ggplot(res,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=res$observed))+ggplot2::xlim(c(-0.1, 0.8))
source("Assignement3function.R")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Category")
test
source("Assignement3function.R")
test<-pearson_x2_stat(stressshift::stress_shift_unamb, "Syllable", "Word")
test
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
res
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
p_3<-ggplot2::ggplot(res,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=test))+ggplot2::xlim(c(-0.1, 0.8))
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
res
propotion_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(Percent_Syll_1=sum(Syllable=="Syllable 1")/n())
percentage_Syllable_1_Noun<-propotion_syllable$Percent_Syll_1[1]
percentage_Syllable_1_Verb<-propotion_syllable$Percent_Syll_1[2]
original_Difference<-percentage_Syllable_1_Noun-percentage_Syllable_1_Verb
rows_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(rows_for_cate=n())
rows_Noun<-rows_syllable$rows_for_cate[1]
rows_Verb<-rows_syllable$rows_for_cate[2]
Noun_N_Syll_1<-rbinom(1000,rows_Noun,percentage_Syllable_1_Noun)
Verb_N_Syll_1<-rbinom(1000,rows_Verb,percentage_Syllable_1_Verb)
col_Noun<-list(c(Noun_N_Syll_1/rows_Noun))
col_Verb<-list(c(Verb_N_Syll_1/rows_Verb))
first_Col<-paste0("R", sprintf("%04d", 1:1000))
stress_shift_replications<-data.frame(first_Col,col_Noun,col_Verb)
col_Name_first_col<-"Identification"
col_Noun_name<-"Noun_Percent_Syll_1"
col_Verb_name<-"Verb_Percent_Syll_1"
names(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name)
difference<-stress_shift_replications[2]-stress_shift_replications[3]
stress_shift_replications<-cbind(stress_shift_replications,di=difference)
colnames(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name,"Difference_in_Proportion")
stress_shift_replications
p<-ggplot2::ggplot(stress_shift_replications,ggplot2::aes_string(x="Difference_in_Proportion",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=original_Difference))+ggplot2::xlim(c(-0.1, 0.8))
p_2<-ggplot2::ggplot(ptest_d,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=median(ptest_stress$observed)))+ggplot2::xlim(c(-0.1, 0.8))
print (p)
print (p_2)
propotion_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(Percent_Syll_1=sum(Syllable=="Syllable 1")/n())
percentage_Syllable_1_Noun<-propotion_syllable$Percent_Syll_1[1]
percentage_Syllable_1_Verb<-propotion_syllable$Percent_Syll_1[2]
original_Difference<-percentage_Syllable_1_Noun-percentage_Syllable_1_Verb
rows_syllable<-dplyr::group_by(stressshift::stress_shift_unamb,Category) %>% dplyr::summarise(rows_for_cate=n())
rows_Noun<-rows_syllable$rows_for_cate[1]
rows_Verb<-rows_syllable$rows_for_cate[2]
Noun_N_Syll_1<-rbinom(1000,rows_Noun,percentage_Syllable_1_Noun)
Verb_N_Syll_1<-rbinom(1000,rows_Verb,percentage_Syllable_1_Verb)
col_Noun<-list(c(Noun_N_Syll_1/rows_Noun))
col_Verb<-list(c(Verb_N_Syll_1/rows_Verb))
first_Col<-paste0("R", sprintf("%04d", 1:1000))
stress_shift_replications<-data.frame(first_Col,col_Noun,col_Verb)
col_Name_first_col<-"Identification"
col_Noun_name<-"Noun_Percent_Syll_1"
col_Verb_name<-"Verb_Percent_Syll_1"
names(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name)
difference<-stress_shift_replications[2]-stress_shift_replications[3]
stress_shift_replications<-cbind(stress_shift_replications,di=difference)
colnames(stress_shift_replications)<-c(col_Name_first_col,col_Noun_name,col_Verb_name,"Difference_in_Proportion")
p<-ggplot2::ggplot(stress_shift_replications,ggplot2::aes_string(x="Difference_in_Proportion",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=original_Difference))+ggplot2::xlim(c(-0.1, 0.8))
ptest_d
p_2<-ggplot2::ggplot(ptest_d,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=median(ptest_stress$observed)))+ggplot2::xlim(c(-0.1, 0.8))
print (p)
print (p_2)
source("Assignement3function.R")
if(!exists(".Random.seed")) set.seed(NULL)
previous_seed <- .Random.seed
set.seed(1)
ptest_stress <- permutation_twogroups(stressshift::stress_shift_unamb,"Syllable", "Category", "Noun", "Verb",difference_in_proportion,n_samples=99,"Syllable 1")
set.seed(previous_seed)
permutation_pvalue_right(ptest_stress)
ptest_stress
ptest_d <- tibble::as_tibble(ptest_stress["permuted"])
p<-ggplot2::ggplot(ptest_d,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=median(ptest_stress$observed)))
print(p)
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
res <- tibble::as_tibble(res["permuted"])
p_3<-ggplot2::ggplot(res,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)+ggplot2::geom_vline(ggplot2::aes(xintercept=test))+ggplot2::xlim(c(-0.1, 0.8))
p_3
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
permutation_test <- function(d, var_to_permute, statistic, n_samples=9, group_var) {
observed_statistic <- statistic(d,var_to_permute, group_var)
permutation_statistics <- rep(0, n_samples)
for (i in 1:n_samples) {
d_perm <- randomize(d, var_to_permute)
permutation_statistics[i] <- statistic(d_perm,var_to_permute,group_var)
}
result <- list(observed=observed_statistic,
permuted=permutation_statistics)
return(result)
}
res<-permutation_test(stressshift::stress_shift_unamb, "Syllable", pearson_x2_stat,99,"Word")
res <- tibble::as_tibble(res["permuted"])
p_3<-ggplot2::ggplot(res,ggplot2::aes_string(x="permuted",y="(..count..)"))+ggplot2::geom_histogram(fill="yellow",colour="black",binwidth=0.005)
p_3
stress_shift_nouns_renamed<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun") %>% dplyr::select(Word,Dict,Syllable) %>% dplyr::rename(Syllable_Noun=Syllable)
stress_shift_nouns_renamed
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun<- tibble::as_tibble(res_Noun["permuted"])
p3<-ggplot2::ggplot(res_Noun,ggplot2::aes(x="permuted",y="(..count..)")+geom_line(colour="red", linetype="dashed", size=1.5))
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun<- tibble::as_tibble(res_Noun["permuted"])
p3<-ggplot2::ggplot(res_Noun,ggplot2::aes(x="permuted",y="(..count..)")+ggplot2::geom_line(colour="red", linetype="dashed", size=1.5))
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun<- tibble::as_tibble(res_Noun["permuted"])
p3<-ggplot2::ggplot(res_Noun,ggplot2::aes(x="permuted",y="(..count..)"))+ggplot2::geom_line(colour="red", linetype="dashed", size=1.5)
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun<- tibble::as_tibble(res_Noun["permuted"])
p3<-ggplot2::ggplot(res_Noun,ggplot2::aes(x="permuted",y="(..count..)"))+ggplot2::geom_line(colour="red", linetype="dashed", size=1.5)
p3
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun<- tibble::as_tibble(res_Noun["permuted"])
p3<-ggplot2::ggplot(res_Noun,ggplot2::aes(y="permuted",x="(..count..)"))+ggplot2::geom_line(colour="red", linetype="dashed", size=1.5)
p3
Noun<-dplyr::filter(stressshift::stress_shift_unamb,Category=="Noun")
res_Noun<-permutation_test(Noun, "Syllable", pearson_x2_stat,99,"Word")
res_Noun<- tibble::as_tibble(res_Noun["permuted"])
p3<-ggplot2::ggplot(res_Noun,ggplot2::aes(y="permuted"))+ggplot2::geom_line(colour="red", linetype="dashed", size=1.5)
p3
